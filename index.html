<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDA | Daynight RP</title>
  <style>
    :root {
      --bg: #0a0a14;
      --panel: rgba(255,255,255,0.04);
      --border: rgba(255,255,255,0.07);
      --text: #f3f3f3;
      --muted: #a0a0b0;
      --accent: #8f5cff;
      --accent2: #00d1ff;
      --success: #3ef6a0;
      --danger: #ff4e6d;
      --radius: 12px;
      --shadow: 0 10px 30px rgba(0,0,0,0.4);
    }

    body {
      font-family: "Inter", sans-serif;
      background: radial-gradient(circle at 20% 20%, rgba(143,92,255,0.1), transparent 50%), var(--bg);
      color: var(--text);
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 20px 40px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
    }

    header h1 {
      font-size: 1.2rem;
      letter-spacing: 0.05em;
      color: var(--accent2);
    }

    main {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      padding: 30px 40px;
    }

    .panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .panel:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 60px rgba(143,92,255,0.25);
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .panel-header h2 {
      font-size: 1rem;
      color: var(--accent);
      margin: 0;
    }

    .panel-body {
      font-size: 0.9rem;
      color: var(--muted);
      flex: 1;
      overflow-y: auto;
      scrollbar-width: thin;
      padding-right: 4px;
    }

    .btn {
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      border: none;
      border-radius: 8px;
      color: #fff;
      padding: 6px 12px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.2s ease;
    }

    .btn:hover {
      filter: brightness(1.1);
    }

    .btn-ghost {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--muted);
      border-radius: 8px;
      padding: 6px 10px;
      cursor: pointer;
      transition: color 0.2s ease, border-color 0.2s ease;
    }

    .btn-ghost:hover {
      color: var(--accent);
      border-color: var(--accent);
    }

    .item {
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 8px;
      border: 1px solid rgba(255,255,255,0.04);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .item strong {
      color: var(--accent2);
    }

    footer {
      text-align: center;
      padding: 20px;
      color: var(--muted);
      font-size: 0.8rem;
      border-top: 1px solid var(--border);
      background: rgba(0,0,0,0.4);
      backdrop-filter: blur(10px);
    }

    /* FiveM-like notifications */
    #notifications {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 9999;
    }

    .notif {
      background: linear-gradient(120deg, rgba(143,92,255,0.9), rgba(0,209,255,0.9));
      color: white;
      padding: 10px 16px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      font-weight: 600;
      animation: notifIn 0.4s ease, notifOut 0.4s ease 3.5s forwards;
    }

    @keyframes notifIn {
      from { opacity: 0; transform: translateY(-10px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    @keyframes notifOut {
      to { opacity: 0; transform: translateY(-10px); }
    }

  </style>
</head>
<body>
  <header>
    <h1>ðŸ“‹ Daynight RP - PDA</h1>
    <button id="refreshAll" class="btn-ghost">Refrescar Todo</button>
  </header>

  <main>
    <div class="panel" id="panelWanted">
      <div class="panel-header">
        <h2>BOLO / Wanted</h2>
        <button class="btn-ghost" onclick="refreshWanted()">âŸ³</button>
      </div>
      <div class="panel-body" id="wantedList"></div>
      <button class="btn" onclick="newWanted()">Nuevo BOLO</button>
    </div>

    <div class="panel" id="panelFines">
      <div class="panel-header">
        <h2>Multas</h2>
        <button class="btn-ghost" onclick="refreshFines()">âŸ³</button>
      </div>
      <div class="panel-body" id="finesList"></div>
      <button class="btn" onclick="newFine()">Nueva Multa</button>
    </div>

    <div class="panel" id="panelAlerts">
      <div class="panel-header">
        <h2>Alertas</h2>
        <button class="btn-ghost" onclick="refreshAlerts()">âŸ³</button>
      </div>
      <div class="panel-body" id="alertsList"></div>
      <button class="btn" onclick="newAlert()">Enviar Alerta</button>
    </div>
  </main>

  <footer>Interfaz CAD Profesional - Estilo Neon Accent | Daynight RP</footer>

  <div id="notifications"></div>

  <script>
    const wantedList = document.getElementById('wantedList');
    const finesList = document.getElementById('finesList');
    const alertsList = document.getElementById('alertsList');
    const notifs = document.getElementById('notifications');

    const state = {
      wanted: [],
      fines: [],
      alerts: []
    };

    /* ========== UTILIDADES ========== */
    function notify(msg) {
      const div = document.createElement('div');
      div.className = 'notif';
      div.textContent = msg;
      notifs.appendChild(div);
      setTimeout(() => div.remove(), 4000);
    }

    /* ========== BOLO / Wanted ========== */
    async function refreshWanted() {
      wantedList.innerHTML = '';
      if (typeof getFirestore === 'function') {
        const snap = await getDocs(collection(getFirestore(), 'wanted'));
        state.wanted = snap.docs.map(d => ({ id: d.id, ...d.data() }));
      }
      if (!state.wanted.length) state.wanted = [{ name: "John Doe", reason: "Sospechoso de robo", priority: "Alta" }];
      state.wanted.forEach(w => {
        const el = document.createElement('div');
        el.className = 'item';
        el.innerHTML = `<div><strong>${w.name}</strong><div>${w.reason}</div></div>
                        <button class="btn-ghost" onclick="delWanted('${w.id}')">Eliminar</button>`;
        wantedList.appendChild(el);
      });
      notify("BOLOs actualizados");
    }

    async function newWanted() {
      const name = prompt("Nombre del sospechoso:");
      const reason = prompt("Motivo:");
      const data = { name, reason, createdAt: new Date().toISOString() };
      if (typeof getFirestore === 'function') {
        await addDoc(collection(getFirestore(), 'wanted'), data);
      }
      state.wanted.push(data);
      refreshWanted();
      notify("Nuevo BOLO aÃ±adido");
    }

    async function delWanted(id) {
      if (typeof getFirestore === 'function' && id) await deleteDoc(doc(getFirestore(), 'wanted', id));
      state.wanted = state.wanted.filter(w => w.id !== id);
      refreshWanted();
      notify("BOLO eliminado");
    }

    /* ========== MULTAS ========== */
    async function refreshFines() {
      finesList.innerHTML = '';
      if (typeof getFirestore === 'function') {
        const snap = await getDocs(collection(getFirestore(), 'fines'));
        state.fines = snap.docs.map(d => ({ id: d.id, ...d.data() }));
      }
      if (!state.fines.length) state.fines = [{ owner: "Carlos DÃ­az", reason: "Exceso de velocidad", amount: 250 }];
      state.fines.forEach(f => {
        const el = document.createElement('div');
        el.className = 'item';
        el.innerHTML = `<div><strong>${f.owner}</strong><div>${f.reason} â€¢ ${f.amount || 0}â‚¬</div></div>
                        <button class="btn-ghost" onclick="delFine('${f.id}')">Eliminar</button>`;
        finesList.appendChild(el);
      });
      notify("Multas actualizadas");
    }

    async function newFine() {
      const owner = prompt("Titular de la multa:");
      const reason = prompt("Motivo:");
      const amount = prompt("Importe (â‚¬):");
      const data = { owner, reason, amount, createdAt: new Date().toISOString() };
      if (typeof getFirestore === 'function') {
        await addDoc(collection(getFirestore(), 'fines'), data);
      }
      state.fines.push(data);
      refreshFines();
      notify("Nueva multa aÃ±adida");
    }

    async function delFine(id) {
      if (typeof getFirestore === 'function' && id) await deleteDoc(doc(getFirestore(), 'fines', id));
      state.fines = state.fines.filter(f => f.id !== id);
      refreshFines();
      notify("Multa eliminada");
    }

    /* ========== ALERTAS ========== */
    async function refreshAlerts() {
      alertsList.innerHTML = '';
      if (typeof getFirestore === 'function') {
        const snap = await getDocs(collection(getFirestore(), 'alerts'));
        state.alerts = snap.docs.map(d => ({ id: d.id, ...d.data() }));
      }
      if (!state.alerts.length) state.alerts = [{ title: "Patrulla requerida", msg: "Central solicita apoyo en sector norte" }];
      state.alerts.forEach(a => {
        const el = document.createElement('div');
        el.className = 'item';
        el.innerHTML = `<div><strong>${a.title || 'Alerta'}</strong><div>${a.msg || ''}</div></div>`;
        alertsList.appendChild(el);
      });
      notify("Alertas actualizadas");
    }

    async function newAlert() {
      const title = prompt("TÃ­tulo de la alerta:");
      const msg = prompt("Mensaje:");
      const data = { title, msg, createdAt: new Date().toISOString() };
      if (typeof getFirestore === 'function') {
        await addDoc(collection(getFirestore(), 'alerts'), data);
      }
      state.alerts.push(data);
      refreshAlerts();
      notify("Nueva alerta enviada");
    }

    /* ========== GENERAL ========== */
    document.getElementById('refreshAll').addEventListener('click', () => {
      refreshWanted();
      refreshFines();
      refreshAlerts();
      notify("Todo actualizado");
    });

    refreshWanted();
    refreshFines();
    refreshAlerts();
  </script>
</body>
</html>
